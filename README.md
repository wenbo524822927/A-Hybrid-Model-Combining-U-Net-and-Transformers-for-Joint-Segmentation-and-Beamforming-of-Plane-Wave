# A Hybrid Model Combining U-net and Transformers for Joint Segmentation and Beamforming of Plane-Wave Ultrasound Images

This repository contains the source code for our work:   
**"A Hybrid Model Combining U-net and Transformers for Joint Segmentation and Beamforming of Plane-Wave Ultrasound Images"**  
The paper was accepted by Ultrasound in Medicine & Biology for publication on Oct 01, 2025.**.  

---

## Abstract
Objective: Recent advancements in deep learning have shown significant potential in ultrasound imaging. However, most approaches focus solely on image enhancement or segmentation, without integrating these tasks into a unified framework. To address this gap, we developed a novel architecture that combines the U-Net and Transformer models to simultaneously segment and beamform plane-wave images acquired from a single insonification.
Methods: The hybrid model was evaluated using computer simulations, physical phantoms containing hypoechoic inclusions (5-10 mm radius) and ultrasound images acquired from the carotid arteries of 50 healthy volunteers. Performance was assessed using six metrics: segmentation accuracy (Dice similarity coefficient, DSC), image fidelity(mean square error, MSE; structural similarity index metric, SSIM), image clarity and contrast (Laplacian variance, LV; generalized contrast-to-noise ratio, gCNR; signal-to-noise ratio, SNR). 
Results: The hybrid model achieved excellent segmentation performance (DSC = 0.98), low error (MSE = 0.017), and high structural similarity (SSIM = 0.765). Its beamformed images were comparable to compound plane wave (CPW) imaging, with SNR and gCNR values of 2.15 and 0.8, respectively, versus 2.4 and 0.9 for CPW imaging. The hybrid model showed reduced accuracy for inclusions â‰¤ 7 mm and occasionally produced spurious inclusions. 
Conclusion: These results demonstrate that hybrid U-Net/Transformer models can reduce reliance on compounding while maintaining image quality, though improvements are needed for small-target detection and artifact suppression. With further optimization, this approach could enable real-time, quantitative ultrasound imaging in clinical settings.

## Requirements
scipy == 1.11.3  
torch == 2.1.0  
torchaudio == 2.1.0  
torchvision == 0.16.0  

## Dataset
Simulation data was generated by Filed II Matlab code.
Phantom/In-vivo data was collected by Verasonic System.
